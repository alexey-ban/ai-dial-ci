name: Deploy App to dev env

on:
  workflow_call:
    inputs:
      DEPLOY_PROJECT_ID:
        required: true
        description: 'The ID or path of the project owned by the authenticated user.'
        type: string
      DEPLOY_REF:
        default: 'master'
        description: 'The branch or tag to run the pipeline on.'
        type: string
    secrets:
      DEPLOY_HOST:
        required: true
      DEPLOY_TRIGGER_TOKEN:
        required: true
      DEPLOY_ACCESS_TOKEN:
        required: true

jobs:
  Build:
    runs-on: ubuntu-20.04
    steps:
      - name: Deploy environment
        id: deploy
        uses: digital-blueprint/gitlab-pipeline-trigger-action@990eaca56dc9b9439da90dd81ab9311adce0dcce # v1.0.5
        with:
          host: ${{ secrets.DEPLOY_HOST }}
          trigger_token: ${{ secrets.DEPLOY_TRIGGER_TOKEN }}
          access_token: ${{ secrets.DEPLOY_ACCESS_TOKEN }}
          id: ${{ secrets.DEPLOY_PROJECT_ID }}
          ref: ${{ secrets.DEPLOY_REF }}
          variables: '{}'
